<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Learning Center</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    body {
      font-family: 'Segoe UI', system-ui, sans-serif;
      background: #0f0f0f;
      color: #f0f0f0;
      margin: 0;
      padding: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .header {
      background: #1a1a1a;
      box-shadow: 0 2px 10px rgba(0,0,0,0.5);
      padding: 1rem 2rem;
      text-align: center;
      border-bottom: 1px solid #333;
      position: relative;
    }

    #sidebarToggle {
      position: absolute;
      left: 1rem;
      top: 50%;
      transform: translateY(-50%);
      background: #333;
      border: none;
      color: #ccc;
      width: 36px;
      height: 36px;
      border-radius: 6px;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      font-size: 1rem;
      transition: background 0.2s;
    }

    #sidebarToggle:hover {
      background: #444;
      color: #fff;
    }

    .header h1 {
      font-weight: 600;
      color: #e0e0e0;
      margin: 0;
      font-size: 1.6rem;
      cursor: pointer; /* Indicates clickable */
    }

    .main-layout {
      display: flex;
      flex: 1;
      padding: 1.5rem;
      gap: 1.5rem;
      max-width: 1400px;
      margin: 0 auto;
      width: 100%;
      transition: padding 0.3s ease;
    }

    .main-layout.centered {
      justify-content: center;
      padding: 1.5rem 0;
    }

    .main-layout.centered .video-panel {
      width: 100%;
      max-width: 1000px;
      margin: 0 1.5rem;
    }

    .title-sidebar {
      width: 300px;
      background: #1a1a1a;
      border-radius: 12px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.4);
      display: flex;
      flex-direction: column;
      max-height: 80vh;
      transition: transform 0.35s ease, opacity 0.35s ease;
    }

    .title-sidebar.hidden {
      transform: translateX(-100%);
      opacity: 0;
      pointer-events: none;
    }

    .video-panel {
      flex: 1;
      background: #1a1a1a;
      border-radius: 12px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.4);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      border: 1px solid #333;
    }

    .search-box-container {
      padding: 1.2rem 1rem 0.8rem;
      position: relative;
    }

    #searchBox {
      width: 100%;
      padding: 0.75rem 36px 0.75rem 1rem;
      border-radius: 8px;
      border: 1px solid #444;
      background: #252525;
      color: #fff;
      font-size: 1rem;
      outline: none;
    }

    #searchBox:focus {
      border-color: #4a90e2;
    }

    .search-icon {
      position: absolute;
      right: 2.2rem;
      top: 50%;
      transform: translateY(-50%);
      color: #888;
    }

    .clear-search {
      position: absolute;
      right: 1rem;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: #aaa;
      cursor: pointer;
      font-size: 1.1rem;
      display: none;
    }

    .clear-search:hover {
      color: #fff;
    }

    .title-list {
      padding: 0.5rem 0;
      overflow-y: auto;
      flex: 1;
      scrollbar-width: thin;
      scrollbar-color: #000 #222;
    }

    .title-list::-webkit-scrollbar {
      width: 8px;
    }
    .title-list::-webkit-scrollbar-track {
      background: #1a1a1a;
    }
    .title-list::-webkit-scrollbar-thumb {
      background: #000;
      border-radius: 4px;
    }
    .title-list::-webkit-scrollbar-thumb:hover {
      background: #333;
    }

    .category-header {
      padding: 0.7rem 1.2rem;
      color: #e0e0e0;
      font-size: 0.95rem;
      font-weight: 600;
      background: #222;
      cursor: pointer;
      display: flex;
      align-items: center;
      user-select: none;
      transition: background 0.2s;
      border-top: 1px solid #333;
    }

    .category-header:first-child {
      border-top: none;
    }

    .category-header:hover {
      background: #2a2a2a;
    }

    .category-header i.chevron {
      margin-right: 0.6rem;
      font-size: 0.8rem;
      transition: transform 0.25s ease;
    }

    .category-header i.chevron.rotated {
      transform: rotate(90deg);
    }

    .category-items {
      overflow: hidden;
      transition: max-height 0.35s ease, padding 0.35s ease;
      max-height: 0;
      padding: 0;
    }

    .title-item {
      padding: 0.85rem 1.2rem 0.85rem 2.5rem;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
    }

    .title-item:hover {
      background: #2a2a2a;
    }

    .title-item.active {
      background: #2d3748;
      font-weight: 600;
      color: #ffffff;
    }

    .title-item i {
      margin-right: 10px;
      font-size: 0.9rem;
      color: #888;
      width: 16px;
      text-align: center;
    }

    .title-item.protected i {
      color: #d97706;
    }

    .video-header {
      padding: 1rem 1.5rem;
      background: #252525;
      border-bottom: 1px solid #333;
    }

    .video-header h2 {
      margin: 0;
      font-size: 1.3rem;
      color: #e0e0e0;
    }

    .video-header .source {
      font-size: 0.85rem;
      color: #aaa;
      margin-top: 0.25rem;
    }

    .video-container {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 1rem;
      background: #0f0f0f;
      position: relative;
    }

    .video-placeholder {
      color: #666;
      font-style: italic;
      text-align: center;
      max-width: 80%;
    }

    .video-container.video-active .video-placeholder {
      display: none;
    }

    .video-container iframe {
      width: 100%;
      height: 100%;
      max-width: 900px;
      max-height: 540px;
      border-radius: 8px;
      border: none;
      display: none;
    }

    .video-container.video-active iframe {
      display: block;
    }

    #passwordModal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.7);
      z-index: 2000;
      justify-content: center;
      align-items: center;
    }
    #passwordModal .modal-content {
      background: #1a1a1a;
      padding: 1.5rem;
      border-radius: 12px;
      width: 90%;
      max-width: 400px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.5);
      border: 1px solid #444;
      color: #f0f0f0;
    }
    #passwordError {
      display: none;
      color: #f87171;
      font-size: 0.85rem;
      margin-top: 0.5rem;
    }

    @media (max-width: 992px) {
      .main-layout {
        padding: 1rem;
      }
      #sidebarToggle {
        left: 0.8rem;
      }
    }
  </style>
</head>
<body>

  <div class="header">
    <button id="sidebarToggle" title="Toggle sidebar (Ctrl+E)">
      <i class="fas fa-bars"></i>
    </button>
    <h1 id="headerTitle"><i class="fas fa-graduation-cap me-2"></i>Learning Center</h1>
  </div>

  <div class="main-layout" id="mainLayout">
    <div class="title-sidebar" id="sidebar">
      <div class="search-box-container">
        <input
          type="text"
          id="searchBox"
          placeholder="Search lessons or categories..."
          autocomplete="off"
        />
        <i class="fas fa-search search-icon"></i>
        <button id="clearSearch" class="clear-search">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="title-list" id="titleList"></div>
    </div>

    <div class="video-panel">
      <div class="video-header">
        <h2 id="currentTitle">Lesson Details</h2>
        <div class="source" id="currentSource"></div>
      </div>
      <div class="video-container" id="videoContainer">
        <div class="video-placeholder">
          Select a lesson to begin
        </div>
        <iframe id="videoFrame" allowfullscreen></iframe>
      </div>
    </div>
  </div>

  <div id="passwordModal">
    <div class="modal-content">
      <h5 class="mb-3"><i class="fas fa-lock me-2"></i>Enter Password</h5>
      <input type="password" id="videoPassword" class="form-control" placeholder="Password" autocomplete="off">
      <p id="passwordError">Incorrect password. Please try again.</p>
      <div class="d-flex justify-content-between mt-3">
        <button id="cancelPassword" class="btn btn-secondary btn-sm">Cancel</button>
        <button id="submitPassword" class="btn btn-primary btn-sm">Unlock Video</button>
      </div>
    </div>
  </div>

  <script>
    const videos = [
      { title: "Top 10 Animation Exercises", type: "youtube", url: "https://youtu.be/qFLsNoiZts0", category: "Important" },
      { title: "Animation as a Career", type: "drive", id: "1D2eXhun3BpgQkUwgXqupLIzEfU4W6ikT", protected: true, category: "Career" },
      { title: "Walk Cycle | Rusty Animator", type: "youtube", url: "https://www.youtube.com/watch?v=STjKkhROdWE", category: "Walk Cycles" },
      { title: "How to Use Reference Videos? | Koushik Chatterjee", type: "youtube", url: "https://youtu.be/vR57xYTQa_E", category: "Workflow Tips" },
      { title: "Import video reference into Maya | Koushik Chatterjee", type: "youtube", url: "https://youtu.be/0w7_5UfrmHE", category: "Maya" },
      { title: "Unlock the Secret to Perfect Splining Animation! | Koushik Chatterjee", type: "youtube", url: "https://youtu.be/Z6SSW5Kw9yo", category: "Splining" },
      { title: "Animation Blocking - You are doing it Wrong! - Part 1 | Jean-Denis Haas", type: "youtube", url: "https://youtu.be/xJ7hmvbl_1c?si=pHyJ25vufillI-Hf", category: "Blocking" },
      { title: "Animation Blocking - Cheat Sheet - Part 2 | Jean-Denis Haas", type: "youtube", url: "https://youtu.be/M3hGbCfb_r8?si=IEj3PMnPPkXStwFP", category: "Blocking" },
      { title: "Get rid of floaty movements and jerks from your animation | Koushik Chatterjee", type: "youtube", url: "https://youtu.be/WzKJOuzV7dE", category: "Polishing" },
      { title: "Front Walk Cycle Animation In After Effects | Jafar Fazel", type: "youtube", url: "https://youtu.be/UaWq3cEzrKc", category: "After Effects" },
      { title: "Front Run Cycle Animation In After Effects | Jafar Fazel", type: "youtube", url: "https://youtu.be/O0a_gu3lYXo", category: "After Effects" },
      { title: "Adding Path to Your Animation | Maya Motion Path", type: "youtube", url: "https://youtu.be/RKA09A_tJt4", category: "Maya" },
      { title: "Master Posing for Animators | Animators Journey", type: "youtube", url: "https://www.youtube.com/watch?v=VrFhQcmM0nw", category: "Posing" },
      { title: "Blocking workflow & simplifying animations | Koushik Chatterjee", type: "youtube", url: "https://youtu.be/rWxeZbwEV70", category: "Workflow Tips" }
    ];

    const VIDEO_PASSWORD = "Animator";

    const sidebar = document.getElementById('sidebar');
    const sidebarToggle = document.getElementById('sidebarToggle');
    const mainLayout = document.getElementById('mainLayout');
    const searchBox = document.getElementById('searchBox');
    const clearSearchBtn = document.getElementById('clearSearch');
    const titleList = document.getElementById('titleList');
    const currentTitle = document.getElementById('currentTitle');
    const currentSource = document.getElementById('currentSource');
    const videoFrame = document.getElementById('videoFrame');
    const videoContainer = document.getElementById('videoContainer');
    const passwordModal = document.getElementById('passwordModal');
    const videoPassword = document.getElementById('videoPassword');
    const submitPassword = document.getElementById('submitPassword');
    const cancelPassword = document.getElementById('cancelPassword');
    const passwordError = document.getElementById('passwordError');
    const headerTitle = document.getElementById('headerTitle');

    let pendingVideo = null;
    let activeItem = null;
    let allCategoriesState = {};
    let sidebarVisible = true;

    const allCats = [...new Set(videos.map(v => v.category || "Uncategorized"))];
    allCats.forEach(cat => {
      allCategoriesState[cat] = false;
    });

    // Toggle sidebar
    function toggleSidebar() {
      sidebarVisible = !sidebarVisible;
      sidebar.classList.toggle('hidden', !sidebarVisible);
      mainLayout.classList.toggle('centered', !sidebarVisible);

      const icon = sidebarToggle.querySelector('i');
      if (sidebarVisible) {
        icon.className = 'fas fa-bars';
        sidebarToggle.title = 'Toggle sidebar (Ctrl+E)';
      } else {
        icon.className = 'fas fa-times';
        sidebarToggle.title = 'Toggle sidebar (Ctrl+E)';
      }
    }

    sidebarToggle.addEventListener('click', toggleSidebar);

    // Keyboard shortcut: Ctrl+E
    document.addEventListener('keydown', (e) => {
      if (e.ctrlKey && e.key === 'e') {
        e.preventDefault();
        toggleSidebar();
      }

      if (e.key === 'Escape') {
        if (passwordModal.style.display === 'flex') {
          passwordModal.style.display = 'none';
          pendingVideo = null;
        }
      }
    });

    // Reset page function
    function resetPage() {
      searchBox.value = '';
      clearSearchBtn.style.display = 'none';
      
      allCats.forEach(cat => {
        allCategoriesState[cat] = false;
      });
      
      renderGroupedList(videos, false);
      
      if (activeItem) {
        activeItem.classList.remove('active');
        activeItem = null;
      }
      
      videoFrame.src = '';
      currentTitle.textContent = 'Lesson Details';
      currentSource.textContent = '';
      videoContainer.classList.remove('video-active');
      
      passwordModal.style.display = 'none';
      pendingVideo = null;
      
      if (!sidebarVisible) {
        sidebarVisible = true;
        sidebar.classList.remove('hidden');
        mainLayout.classList.remove('centered');
        const icon = sidebarToggle.querySelector('i');
        icon.className = 'fas fa-bars';
        sidebarToggle.title = 'Toggle sidebar (Ctrl+E)';
      }
      
      searchBox.focus();
    }

    headerTitle.addEventListener('click', resetPage);

    // --- Video logic ---
    function getYouTubeId(url) {
      const regExp = /^.*(youtu\.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
      const match = url.match(regExp);
      return (match && match[2].length === 11) ? match[2] : null;
    }

    function getEmbedUrl(video) {
      if (video.type === "youtube") {
        const id = getYouTubeId(video.url);
        return id ? `https://www.youtube.com/embed/${id}?autoplay=1` : null;
      } else if (video.type === "drive") {
        return `https://drive.google.com/file/d/${video.id}/preview`;
      }
      return null;
    }

    function getSourceLabel(type) {
      return type === "youtube" ? "YouTube" : "Google Drive";
    }

    function loadVideo(video) {
      const embedUrl = getEmbedUrl(video);
      if (embedUrl) {
        currentTitle.textContent = video.title;
        currentSource.textContent = `Source: ${getSourceLabel(video.type)}`;
        videoFrame.src = embedUrl;
        videoContainer.classList.add('video-active');
      } else {
        currentTitle.textContent = "Error loading video";
        currentSource.textContent = "";
        videoFrame.src = "";
        videoContainer.classList.remove('video-active');
      }
    }

    function selectVideo(video, element) {
      if (activeItem) activeItem.classList.remove('active');
      if (element) {
        element.classList.add('active');
        activeItem = element;
      }

      if (video.protected) {
        pendingVideo = video;
        passwordModal.style.display = 'flex';
        videoPassword.value = '';
        passwordError.style.display = 'none';
        videoPassword.focus();
      } else {
        loadVideo(video);
      }
    }

    function toggleCategory(header, itemsContainer, chevron, categoryName) {
      const isExpanded = allCategoriesState[categoryName];
      if (isExpanded) {
        itemsContainer.style.maxHeight = '0px';
        itemsContainer.style.padding = '0';
        chevron.classList.remove('rotated');
        allCategoriesState[categoryName] = false;
      } else {
        itemsContainer.style.display = 'block';
        const realHeight = itemsContainer.scrollHeight;
        itemsContainer.style.display = '';
        itemsContainer.style.maxHeight = realHeight + 'px';
        itemsContainer.style.padding = '0.2rem 0';
        chevron.classList.add('rotated');
        allCategoriesState[categoryName] = true;
      }
    }

    function renderGroupedList(videoList, isSearching = false) {
      if (isSearching) {
        const grouped = {};
        videoList.forEach(v => {
          const cat = v.category || "Uncategorized";
          if (!grouped[cat]) grouped[cat] = [];
          grouped[cat].push(v);
        });

        titleList.innerHTML = '';
        const categories = Object.keys(grouped).sort();

        categories.forEach(cat => {
          const header = document.createElement('div');
          header.className = 'category-header';
          header.innerHTML = `<i class="fas fa-chevron-right chevron rotated"></i> ${cat} <span class="text-muted ms-2">(${grouped[cat].length})</span>`;
          titleList.appendChild(header);

          const itemsContainer = document.createElement('div');
          itemsContainer.className = 'category-items';
          itemsContainer.style.maxHeight = '1000px';
          itemsContainer.style.padding = '0.2rem 0';

          grouped[cat].forEach(video => {
            const item = document.createElement('div');
            item.className = 'title-item';
            if (video.protected) item.classList.add('protected');
            item.innerHTML = `<i class="fas ${video.protected ? 'fa-lock' : 'fa-play'}"></i> ${video.title}`;
            item.addEventListener('click', () => selectVideo(video, item));
            itemsContainer.appendChild(item);
          });

          titleList.appendChild(itemsContainer);
        });
      } else {
        const grouped = {};
        videos.forEach(v => {
          const cat = v.category || "Uncategorized";
          if (!grouped[cat]) grouped[cat] = [];
          grouped[cat].push(v);
        });

        titleList.innerHTML = '';
        const categories = Object.keys(grouped).sort();

        categories.forEach(cat => {
          const isExpanded = allCategoriesState[cat];

          const header = document.createElement('div');
          header.className = 'category-header';
          header.dataset.category = cat;
          header.innerHTML = `<i class="fas fa-chevron-right chevron ${isExpanded ? 'rotated' : ''}"></i> ${cat}`;
          titleList.appendChild(header);

          const itemsContainer = document.createElement('div');
          itemsContainer.className = 'category-items';
          if (isExpanded) {
            itemsContainer.style.display = 'block';
            const height = itemsContainer.scrollHeight;
            itemsContainer.style.display = '';
            itemsContainer.style.maxHeight = height + 'px';
            itemsContainer.style.padding = '0.2rem 0';
          } else {
            itemsContainer.style.maxHeight = '0px';
            itemsContainer.style.padding = '0';
          }

          grouped[cat].forEach(video => {
            const item = document.createElement('div');
            item.className = 'title-item';
            if (video.protected) item.classList.add('protected');
            item.innerHTML = `<i class="fas ${video.protected ? 'fa-lock' : 'fa-play'}"></i> ${video.title}`;
            item.addEventListener('click', () => selectVideo(video, item));
            itemsContainer.appendChild(item);
          });

          titleList.appendChild(itemsContainer);

          header.addEventListener('click', () => {
            toggleCategory(header, itemsContainer, header.querySelector('.chevron'), cat);
          });
        });
      }
    }

    function performSearch() {
      const query = searchBox.value.trim().toLowerCase();
      if (!query) {
        renderGroupedList(videos, false);
        clearSearchBtn.style.display = 'none';
        return;
      }

      const filtered = videos.filter(v =>
        v.title.toLowerCase().includes(query) ||
        (v.category && v.category.toLowerCase().includes(query))
      );

      renderGroupedList(filtered, true);
      clearSearchBtn.style.display = 'block';
    }

    searchBox.addEventListener('input', performSearch);
    clearSearchBtn.addEventListener('click', () => {
      searchBox.value = '';
      clearSearchBtn.style.display = 'none';
      renderGroupedList(videos);
      searchBox.focus();
    });

    function validatePassword() {
      if (videoPassword.value === VIDEO_PASSWORD) {
        passwordModal.style.display = 'none';
        if (pendingVideo) {
          loadVideo(pendingVideo);
          pendingVideo = null;
        }
      } else {
        passwordError.style.display = 'block';
        setTimeout(() => passwordError.style.display = 'none', 2000);
      }
    }

    submitPassword.addEventListener('click', validatePassword);
    videoPassword.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') validatePassword();
    });
    cancelPassword.addEventListener('click', () => {
      passwordModal.style.display = 'none';
      pendingVideo = null;
    });

    renderGroupedList(videos);
    searchBox.focus();
  </script>
</body>
</html>
